<div
  [class]="
    'mb-8 px-4 md:px-10 py-8 relative' +
    (section().backgroundColor ? ' ' + section().backgroundColor : ' bg-white')
  "
>
  <!-- Section Header -->
  <div class="flex justify-between items-center pr-4 mb-4">
    <div class="flex items-center gap-2">
      <img [src]="section().icon" [alt]="section().title" class="w-6 h-6" />
      <h2
        class="text-[18px] font-bold"
        [class]="titleColor === 'dark' ? 'text-gray-800' : 'text-white'"
      >
        {{ section().title }}
      </h2>
    </div>
  </div>

  <!-- Audio Carousel Container -->
  <div class="relative" style="z-index: 2; position: relative">
    <!-- Navigation Buttons -->
    <button
      (click)="scrollLeft()"
      class="absolute left-0 top-1/2 transform -translate-y-1/2 z-10 bg-white !rounded-full shadow-lg p-2 hover:bg-gray-50 transition-colors duration-200 md:flex items-center justify-center cursor-pointer"
      style="width: 40px; height: 40px; margin-left: -15px"
    >
      <svg viewBox="0 0 24 24" class="w-5 h-5 text-black">
        <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z" fill="currentColor" />
      </svg>
    </button>

    <button
      (click)="scrollRight()"
      class="absolute right-0 top-1/2 transform -translate-y-1/2 z-10 bg-white !rounded-full shadow-lg p-2 hover:bg-gray-50 transition-colors duration-200 md:flex items-center justify-center cursor-pointer"
      style="width: 40px; height: 40px; margin-right: -15px"
    >
      <svg viewBox="0 0 24 24" class="w-5 h-5 text-black">
        <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z" fill="currentColor" />
      </svg>
    </button>

    <!-- Carousel Content -->
    <div
      #carousel
      class="overflow-x-auto scrollbar-hidden"
      style="scroll-snap-type: x mandatory; scrollbar-width: none; -ms-overflow-style: none"
    >
      <div class="flex space-x-2 md:space-x-4 pb-4" style="width: max-content">
        @for (mix of section().data; track mix.link) {
        <div class="flex-shrink-0 duration-300 block" style="width: 250px; scroll-snap-align: start">
          @if (isAudioFile(mix.link)) {
            <!-- Audio Mix with Play Button -->
            <div (click)="playAudio(mix, $event)" class="group relative cursor-pointer">

              <img
                [src]="mix.image"
                [alt]="mix.title || 'Audio Mix'"
                class="rounded-lg aspect-square w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
              />
              <!-- Absolute Play Icon Button Overlay -->
              <button
                type="button"
                (click)="playAudio(mix, $event)"
                class="absolute inset-0 flex items-center justify-center transition duration-300 rounded-lg"
                style="border: none; outline: none; width: 100%; height: 100%; z-index: 2; background: transparent;"
                aria-label="Play audio"
              >
                <span class="bg-white bg-opacity-90 rounded-full p-3 shadow-lg group-hover:scale-110 transition-transform duration-300">
                  <svg class="w-8 h-8 text-gray-800" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M8 5v14l11-7z"/>
                  </svg>
                </span>
              </button>

              <!-- Hover Overlay -->
              <div class="absolute inset-0 bg-black opacity-0 group-hover:opacity-30 duration-300 rounded-lg"></div>

              <!-- Simple Play Icon -->
              <div class="absolute inset-0 flex items-center justify-center">
                @if (isCurrentTrack(mix) && audioService.isPlaying()) {
                  <!-- Currently Playing Indicator -->
                  <div class="bg-white bg-opacity-90 rounded-full p-3 shadow-lg">
                    <svg class="w-8 h-8 text-gray-800" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/>
                    </svg>
                  </div>
                } @else {
                  <!-- Play Button (shown on hover) -->
                  <div class="bg-white bg-opacity-90 rounded-full p-3 opacity-0 group-hover:opacity-100 transition-all duration-300 hover:scale-110 shadow-lg">
                    <svg class="w-8 h-8 text-gray-800" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M8 5v14l11-7z"/>
                    </svg>
                  </div>
                }
              </div>

              <!-- Track Title -->
              @if (mix.title) {
                <div class="absolute bottom-2 left-2 right-2">
                  <p class="text-white text-sm font-medium bg-black bg-opacity-50 rounded px-2 py-1 truncate">
                    {{ mix.title }}
                  </p>
                </div>
              }
            </div>
          } @else {
            <!-- External Link -->
            <a
              [href]="mix.link"
              [attr.rel]="mix.link?.includes('http') ? 'noopener noreferrer' : null"
              [attr.target]="mix.link?.includes('http') ? '_blank' : null"
              class="group relative block"
            >
              <img
                [src]="mix.image"
                [alt]="mix.title || 'Audio Mix'"
                class="rounded-lg aspect-square w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
              />
              <div class="absolute inset-0 bg-black opacity-0 group-hover:opacity-20 duration-300 rounded-lg"></div>

              <!-- Track Title -->
              @if (mix.title) {
                <div class="absolute bottom-2 left-2 right-2">
                  <p class="text-white text-sm font-medium bg-black bg-opacity-50 rounded px-2 py-1 truncate">
                    {{ mix.title }}
                  </p>
                </div>
              }
            </a>
          }
        </div>
        }
      </div>
    </div>
  </div>

  <!-- Decorative Stripes (for "More Mixes" section) -->
  @if (section().decorativeStripes) {
  <div
    class="absolute inset-x-0 top-1/2 transform -translate-y-1/2 hidden md:inline"
    style="z-index: 1"
  >
    <div class="w-full h-5 bg-[#FF40A4] mb-2"></div>
    <div class="w-full h-5 bg-[#FF40A4] mb-2"></div>
    <div class="w-full h-5 bg-[#FF40A4] mb-2"></div>
    <div class="w-full h-5 bg-[#FF40A4] mb-2"></div>
  </div>
  }
</div>